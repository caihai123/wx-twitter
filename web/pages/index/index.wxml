<!--pages/index/index.wxml-->

<wxs module="tools">
  module.exports = {
    includes: function (arr, item) {
      var len = arr.length;
      for (var i = 0; i < len; i++) {
        if (arr[i] === item) {
          return true
        }
      }
      return false
    },
  }
</wxs>

<view>
  <view class="post-item" wx:for="{{posts}}" wx:key="id">
    <view class="post-main">
      <view class="post-aside">
        <van-image width="48" height="48" round lazy-load src="{{item.user.avatarUrl}}" />
      </view>
      <view class="post-body">
        <view class="post-head ellipsis">
          <view class="user-bar">
            <view class="nick-name ellipsis">{{item.user.nickName}}</view>
            <view class="date">2月16日</view>
          </view>
          <view>
            <van-icon name="ellipsis" custom-class="icon-ellipsis" />
          </view>
        </view>
        <view class="post-content">
          <!-- 文本 -->
          <view class="post-text">{{item.content}}</view>
          <view wx:if="{{item.imgList}}" class="img-thum-box">
            <img-thum-box img-list="{{item.imgList}}" />
          </view>
        </view>
        <view class="post-foot">
          <view class="tool-item">
            <van-icon name="like-o" />{{item.watching}}
          </view>
          <view class="tool-item">
            <van-icon name="chat-o" />{{item.comments}}
          </view>
          <view class="tool-item" data-id="{{item.id}}" bindtap="thumbsUp">
            <view wx:if="{{tools.includes(item.thumbsUp,ownId)}}" style="color:#de265c">
              <van-icon name="good-job" />
              <text class="num" wx:if="{{item.thumbsUp.length}}">{{item.thumbsUp.length}}</text>
            </view>
            <view wx:else>
              <van-icon name="good-job-o" />
              <text class="num" wx:if="{{item.thumbsUp.length}}">{{item.thumbsUp.length}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>

<view class="float-button">
  <van-button type="default" type="info" round icon="plus" bind:click="goCreatdPost"></van-button>
</view>